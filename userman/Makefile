###
#
# Copyright (C) 2003,2004,2005,2006,2007,2008,2009 Fredrik Lingvall
#
# This file is part of the DREAM Toolbox.
#
# The DREAM Toolbox is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by the
# Free Software Foundation; either version 2, or (at your option) any
# later version.
#
# The DREAM Toolbox is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
# FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
# for more details.
#
# You should have received a copy of the GNU General Public License
# along with the DREAM Toolbox; see the file COPYING.  If not, write to the
# Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
# 02110-1301, USA.
#
###

# $Revision: 621 $ $Date: 2009-11-09 10:19:12 +0100 (Mon, 09 Nov 2009) $ $LastChangedBy: dream $

#
# Makefile for the DREAM toolbox user manual.
#

include ../Make.inc

all: clean userman.dvi userman.ps userman.pdf html

dvi: userman.dvi
ps: userman.ps
pdf: userman.pdf

userman.dvi: userman_pre.tex userman_post.tex userman.bib
	cat userman_pre.tex > userman.tex
	echo "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% " >> userman.tex
	echo "% " >> userman.tex
	echo "% Do not edit this file! It is auto-generated. Edit the userman_post.tex" >> userman.tex
	echo "% file instead!" >> userman.tex
	echo "% " >> userman.tex
	echo "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% " >> userman.tex
	echo " " >> userman.tex
	echo " " >> userman.tex
	echo "\setboolean{TEX4HT}{false}" >> userman.tex
	echo " " >> userman.tex
	echo "\usepackage[colorlinks=true,linkcolor=blue,ps2pdf]{hyperref}" >> userman.tex
	echo "\title{\textbf{User Manual for the DREAM Toolbox\\\ " >> userman.tex
	echo "Version "  >> userman.tex
	cat ../VERSION  >> userman.tex
	echo "}\\\ "  >> userman.tex
	echo "% " >> userman.tex
	echo "% " >> userman.tex
	cat userman_post.tex >> userman.tex
	latex userman
	bibtex userman
	latex userman
	latex userman

userman.ps:userman.dvi
	dvips -z -Ppdf -G0 userman -o userman.ps

userman.pdf: userman.ps
	 ps2pdf -SPAPERSIZE=a4 userman.ps


# latex2html
#html: userman.dvi
#	rm -fR userman_html/
#	rm -f userman_html.tex userman_html.bbl	userman_html.bbl
#	ln -s userman.tex userman_html.tex
#	ln -s userman.aux userman_html.aux
#	ln -s userman.bbl userman_html.bbl
#	latex2html -split 0 -noreuse -show_section_numbers -contents_in_navigation -html_version 3.2 userman_html.tex
#	rm -f userman_html.tex userman_html.aux userman_html.bbl
##	latex2html -split 0 -noreuse -show_section_numbers -contents_in_navigation userman_html.tex

# tex4ht
html:  userman_pre.tex userman_post.tex userman.bib
	rm -f *~  *.dvi *.aux *.bbl *.blg *.log *.toc *.tmp *.lg *.idv *.png *.4ct *.4tc *.xref
	cat userman_pre.tex > userman.tex
	echo "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% " >> userman.tex
	echo "% " >> userman.tex
	echo "% Do not edit this file! It is auto-generated. Edit the userman_post.tex" >> userman.tex
	echo "% file instead!" >> userman.tex
	echo "% " >> userman.tex
	echo "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% " >> userman.tex
	echo " " >> userman.tex
	echo "\setboolean{TEX4HT}{true}" >> userman.tex
	echo " " >> userman.tex
	echo "\usepackage[colorlinks=true,linkcolor=blue,tex4ht]{hyperref}" >> userman.tex
	echo "\title{\textbf{User Manual for the DREAM Toolbox\\\ " >> userman.tex
	echo "Version "  >> userman.tex
	cat ../VERSION  >> userman.tex
	echo "}\\\ "  >> userman.tex
	cat userman_post.tex >> userman.tex
	mk4ht mzlatex  userman "xhtml,mathml-"
	bibtex userman
	mk4ht mzlatex  userman "xhtml,mathml-"
	mk4ht mzlatex  userman "xhtml,mathml-"

install:
	echo "Install userman for Matlab and Octave"
	cp -a userman.pdf ../$(INSTALL_DIR)userman-$(VER).pdf
	mkdir -p ../html/userman_html
	cp ../$(INSTALL_DIR)userman-$(VER).pdf ../html/
	cp -a *.xml ../html/userman_html/
	cp -a *.css ../html/userman_html/
	cp -a *.png ../html/userman_html/
#	cp -a userman_html/ ../html/
clean:
	rm -f *~  *.dvi *.aux *.bbl *.blg *.log *.toc *.tmp *.lg *.idv *.png *.4ct *.4tc *.xref *.out *.fls *.xht

distclean:
	rm -fR *~  *.dvi *.aux *.bbl *.blg *.log *.toc *.tmp *.lg *.idv *.png *.4ct *.4tc *.xref \
	*.out *.fls *.ps *.pdf userman_html/  *.css *.xml *.html *.xht
